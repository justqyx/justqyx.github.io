
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JustQyx</title>
  <meta name="author" content="邱源鑫">

  
  <meta name="description" content="作为一个「图样图森破」的人，向前辈学习是我的主旋律，以下是我获取信息和知识的主要渠道。 微信公众号 关注一些冯大辉、池建强、三表龙门阵、李笑来、吴晓波频道、caozsay等公号，常能够获取到一些有趣的东西。 微博 &amp;&amp; twitter 国内外的牛人或是技术达人，都常年活跃在微博和 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.justqyx.me/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="JustQyx" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-65882934-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">JustQyx</a></h1>
  
    <h2>大道至简</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="hzuqiuyuanxin@gmail.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="www.justqyx.me">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/categories">Categories</a></li>
  <li><a href="/blog/blogs">Blogs</a></li>
  <li><a href="/blog/about">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/03/04/how-do-i-collect-tech-infomation/">How Do I Collect Tech Infomation</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-04T10:55:14+08:00'><span class='date'>2016-03-04 10:55:14</span> <span class='time'>10:55 am</span></time>
        
           | <a href="/blog/2016/03/04/how-do-i-collect-tech-infomation/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/03/04/how-do-i-collect-tech-infomation/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作为一个「图样图森破」的人，向前辈学习是我的主旋律，以下是我获取信息和知识的主要渠道。</p>

<h2>微信公众号</h2>

<p>关注一些冯大辉、池建强、三表龙门阵、李笑来、吴晓波频道、caozsay等公号，常能够获取到一些有趣的东西。</p>

<h2>微博 &amp;&amp; twitter</h2>

<p>国内外的牛人或是技术达人，都常年活跃在微博和 twitter，关注他们日常所关注的，适当地选择一些点作为自己进步的方向标，不断地思考和修正自己的方向。</p>

<p>同时有名的开源项目在 twitter 都有官方账号，可以在那里获得最新相关的资讯。</p>

<p>社交网站能够让我对最新的技术或者一些大事件保持敏感，同时使用 Pocket 保存一些觉得有用的网页并打上标签分类，不时地拿出来翻翻。</p>

<h2>播客</h2>

<p>IPN 旗下的节目都不错，另外作为一个 Rubist 也应该订阅 Teahour。</p>

<h2>博客</h2>

<p>自从 Google Reader 关闭之后，我开始使用 Feedly 订阅一些好的博客，内容一般是日常开发中遇到的问题以及相应的解决方案。</p>

<h2>书籍</h2>

<p>真正的干货，永远只存在于好的书籍里，推荐《如何阅读一本书》，它可以指导你如何阅读一本书，同时也指导你如何去选一本好书。</p>

<p>好的书籍则能够让你更加脚踏实地地进步，它相当于这本书的作者在非常认真地跟你讲 ta 在这个领域所掌握的知识，这是花多少钱都买不来的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/17/ruby-app-server/">Ruby App Server 常用的三种 I/O 模型</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-17T11:06:27+08:00'><span class='date'>2016-02-17 11:06:27</span> <span class='time'>11:06 am</span></time>
        
           | <a href="/blog/2016/02/17/ruby-app-server/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/17/ruby-app-server/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>所有的 Web 应用都遵循着一个基本模型。首先，它们需要从一些 I/O 通道接收 HTTP 请求，
然后处理这些请求，最后输出 HTTP 响应体，这个响应体将会被发送回 HTTP 客户端。
这个 HTTP 客户端通常是 Web 浏览器，又或者是一些像 curl 这一类的工具，又或者是搜索引擎的爬虫。</p>

<h2>Ruby app server</h2>

<p>Ruby app server 其实就是 HTTP Server，能与 HTTP client 直接进行对话的服务。<br/>
Ruby 里常见的 app server 的有 thin、Unicorn、Puma、Passenger。</p>

<h2>Ruby web app</h2>

<p>Ruby web app 是基于像 Rails、Sinatra 这一类框架所构建出来的应用，它并不直接与 HTTP 打交道。</p>

<p>如果 Ruby web app 直接与 HTTP 请求打交道的话，那么每一个 Ruby Web app 都需要实现与 HTTP 打交道，
所以为了简化这一过程，Ruby web app 只需要与一个被抽象过的 HTTP 请求和响应打交道，在 Ruby 生态里，最流行的便是 Rack。</p>

<p>Unicorn、Puma 和 Passenger 这一类的 app server 实现了 Rack 接口，因此 Ruby web app 能够和 Ruby app server
进行无缝对接。</p>

<p><img src="/downloads/images/rack.png"></p>

<p>理解完 Ruby app server 和 Ruby web app 的概念后，让我们来看看常见的三种连接处理和 I/O 模型（Connection handling and I/O models）。</p>

<h2>Multi-process blocking I/O</h2>

<p><img src="/downloads/images/multi-process-io.png"></p>

<p>一个进程每次只处理一个客户端（的请求），通过多进程的方式来实现并发。</p>

<p>读操作会被阻塞如果另一端没有发送任何数据，同样写操作也会被阻塞如果另一端接收数据太慢。
因为这样的特性，所以一个进程每次只能处理一个客户端（的请求）。
想要处理多少个客户端（的请求），就需要多少个进程。</p>

<p>这是一种传统的 I/O 模型，被 Unicorn 和 <a href="http://httpd.apache.org/docs/current/mod/prefork.html">Apache with the prefork NPM</a> 所采用。</p>

<p><strong>优点</strong></p>

<ul>
<li>使用非常简单</li>
<li>线程安全</li>
</ul>


<p><strong>缺点</strong></p>

<ul>
<li>进程开销大</li>
<li>I/O 阻塞导致吞吐量低</li>
</ul>


<h2>Multi-threaded blocking I/O</h2>

<p><img src="/downloads/images/multithreaded-io.png"></p>

<p>I/O 调用仍然会阻塞，但通过创建线程来替代进程。
一个进程可以有许多线程，每一个线程一次处理一个客户端（的请求）。
因为线程是轻量级的，你可以使用更少的内存处理同样数量的的 I/O 并发。
要服务 5000 个 websocket 客户端，你总共需要 5000 个线程，假设你在一个台8核的机器上运行了
8 个应用进程，那么每个进程需要配置 625 个线程，这对于 Ruby 和 OS 来说是非常容易的。
一个进程可能需要 1GB 或者更少的内存，这样对于 8 个进程来说需要 8GB 的内存，
比起多进程阻塞 I/O 模型来说的 1.2TB 来说是非常小的。</p>

<p>这个 I/O 模型被 Torquebox 和 <a href="http://httpd.apache.org/docs/current/mod/worker.html">Apache with the worker MPM</a> 所使用。
也是 Puma 经常使用的模型之一，Puma 采用了一种带限制的混合策略。</p>

<p><strong>优点</strong></p>

<ul>
<li>对于类似 <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">embarassingly parallel</a> 的工作负载，
比如 web 请求，使用线程来处理客户端 I/O 还是非常容易的。</li>
</ul>


<p><strong>缺点</strong></p>

<ul>
<li>应用程序所有的代码和依赖的库必须是线程安全的</li>
<li>应用服务必须被反向代理保护，原因和多进程 I/O 模型一样，相比较而言，虽然多线程的应用服务不太容易受 slow client 影响，
但是也并没有完全解决 slow client 的问题</li>
</ul>


<h2>Evented I/O</h2>

<p><img src="/downloads/images/event-io.png"></p>

<p>在这种模型里，I/O 调用完全不会被阻塞。
当另一端没有发送数据，或者接收数据太慢，I/O 调用只是返回一个特定的错误。
应用程序有一个持续监听并响应 I/O 事件的事件循环，当没有事件时，该循环会进入睡眠状态。</p>

<p>这是目前最为怪异（weirdest）和难以编写的一种 I/O 模型。
它需要与前面两种模型完全不同的方法，当多进程阻塞 I/O 模型的代码非常容易转换成为多线程阻塞 I/O 模型的代码，
但是如果使用 Evented I/O 模型的话，通常情况下代码需要重写。使用 Evented I/O 模型的程序需要特定的设计。</p>

<p>这样的 I/O 模型被 Nignx、Nodejs 和 Thin 所采用，同时它也被 Puma 部分采用以限制 slow client 达到保护的目的。</p>

<p><strong>优点</strong></p>

<ul>
<li>使用这个模型你可以仅仅使用一个进程和一个线程便可以处理无限量的 I/O 并发，同时资源使用也非常少。
虽然多线程已经能够处理非常多的 I/O 并发，但 Evented I/O 还要多得多。</li>
<li>采用该模型的服务器，对 slow client 是免疫的（immune），所以可以不需要一个缓冲反向代理。</li>
</ul>


<p><strong>缺点</strong></p>

<ul>
<li>相比于阻塞型 I/O 模型，事件模型要难掌握地多，并且需要你时刻记住应用代码和库要适配该模型。</li>
</ul>


<h2>经验</h2>

<p>Nginx + Unicorn 是一个不错的选择，并且 Unicorn 支持 hot restart，部署过程对用户的使用影响较小。</p>

<p>如果遇到 websocket 这一类的需求，那么 Puma (support hot restart) 单独部署这需求相关的功能是不错的。</p>

<p>如果遇到高 I/O 的场景，如消息群发通知，那么使用 Node来实现与外部服务交互，性能是比较理想的。相信 Rubist 都会 Node。</p>

<h2>Ref</h2>

<ul>
<li><a href="http://www.rubyraptor.org/how-we-made-raptor-up-to-4x-faster-than-unicorn-and-up-to-2x-faster-than-puma-torquebox">How we made raptor up to 4x faster than unicorn and up to 2x faster than puma torquebox</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/16/books-reading-this-year/">今年要读的书</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-16T14:37:35+08:00'><span class='date'>2016-02-16 14:37:35</span> <span class='time'>2:37 pm</span></time>
        
           | <a href="/blog/2016/02/16/books-reading-this-year/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/16/books-reading-this-year/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>前言</h2>

<p>得益于如今的互联网和技术圈的氛围，使得我可以不断地修正自己的方向。</p>

<h2>List</h2>

<ul>
<li><strong>《批判性思维：带你走出思维的误区》</strong></li>
</ul>


<blockquote><p>出生在农村的我，先天教育的落后，导致我智商、情商都落后，加上信息透明度不够，<br/>
在这社会行走，太容易被人忽悠。<br/>
人傻要多读书，人傻要多读书，人傻要多读书。</p></blockquote>

<ul>
<li><strong>《垃圾回收的算法与实现》</strong></li>
</ul>


<blockquote><p>今年将要出版的一本书，<a href="https://twitter.com/_kaichen">@陈恺</a>师兄介绍，他正在帮忙审查这本书。<br/>
Ruby 的 GC 话题在 2014 和 2015 年都非常火，最新几个版本的重点也都在于对虚拟机性能的提升。</p></blockquote>

<ul>
<li><strong>《HTTP 权威指南》</strong></li>
<li><strong>《Webkit 技术内幕》</strong></li>
<li><strong>《白帽子讲 Web 安全》</strong></li>
</ul>


<blockquote><p>与其在网上看一堆文章（特别是百度搜出来的），还不如静下心来看看书，这才是精华。<br/>
另外，我只用谷歌，最差也是 global.bing.com。</p></blockquote>

<ul>
<li><strong>《领域特定语言》</strong></li>
<li><strong>《企业应用架构模式》</strong></li>
</ul>


<blockquote><p>这两年或多或少接触这些领域的概念，但一直没有迈开脚步，有许多原因，现在就先迈出一步吧。<br/>
工程化，是我接下来需要修习的一门课。</p></blockquote>

<ul>
<li><strong>《写给大家看的设计书》</strong></li>
</ul>


<blockquote><p>我讨厌不好看的 UI，就跟我用了 Mac 之后再也回不去 Windows 一样。<br/>
另外这篇扯淡博文，我调了四五次格式，但还是丑 &hellip;</p></blockquote>

<ul>
<li><strong>《创业维艰》</strong></li>
<li><strong>《从0到1：开启商业与未来的秘密》</strong></li>
</ul>


<blockquote><p>某一天，我也希望有自己的工作室或者公司，当老板的都是苦逼的，能不苦逼的，干的都是写在宪法里的事情。</p></blockquote>

<ul>
<li><strong>《激荡三十年（上）》</strong></li>
<li><strong>《激荡三十年（上）》</strong></li>
<li><strong>《货币战争：真相与未来》</strong></li>
</ul>


<blockquote><p>没错，我对财经也感兴趣。<br/>
前两本是前老板写的，没错，就是那个财经界的吴晓波，据说有一段时间，杭州武林门有一条街都是他的。<br/>
最后一本也许是个坑，还有也许三本都是坑。</p></blockquote>

<ul>
<li><strong>《失控》</strong></li>
<li><strong>《必然》</strong></li>
</ul>


<blockquote><p>还来，你以为我这么喜欢看书的啊，但是凯文•凯利的，那就勉强看看吧。</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/16/build-a-dsl-in-ruby/">Building a DSL in Ruby</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-16T10:23:27+08:00'><span class='date'>2016-02-16 10:23:27</span> <span class='time'>10:23 am</span></time>
        
           | <a href="/blog/2016/02/16/build-a-dsl-in-ruby/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/16/build-a-dsl-in-ruby/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>DSL（领域专用语言，Domain Specific Language）不是一个新的技术概念，并且构建是困难的。
其至少包含两个内容：</p>

<ol>
<li>一个用于解析 DSL 的 Parser</li>
<li>使用 DSL 写出来的程序</li>
</ol>


<h2>构建一个简单的 Quiz DSL</h2>

<p>最终我们想达到的效果便是，当运行程序之后，会让用户做选择题，并且统计回答正确的题数。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Who was the first president of the USA?
</span><span class='line'>1 - Fred Flintstone
</span><span class='line'>2 - Martha Washington
</span><span class='line'>3 - George Washington
</span><span class='line'>4 - George Jetson
</span><span class='line'>Enter your answer:</span></code></pre></td></tr></table></div></figure>


<p>期望的表达语法</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># questions.qm</span>
</span><span class='line'>
</span><span class='line'><span class="n">question</span> <span class="s2">&quot;Who was the first president of the USA?&quot;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;Fred Flintstone&#39;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;Martha Washington&#39;</span>
</span><span class='line'><span class="n">right</span> <span class="s1">&#39;George Washington&#39;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;George Jetson&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">question</span> <span class="s1">&#39;Who is buried in Grant\&#39;s tomb?&#39;</span>
</span><span class='line'><span class="n">right</span> <span class="s1">&#39;U. S. Grant&#39;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;Cary Grant&#39;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;Hugh Grant&#39;</span>
</span><span class='line'><span class="n">wrong</span> <span class="s1">&#39;W. T. Grant&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>一个简单的 Parser</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># quizm.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">question</span> <span class="n">text</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Just read a question: </span><span class="si">#{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">wrong</span> <span class="n">text</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Just read a correct answer: </span><span class="si">#{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">right</span> <span class="n">text</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Just read an incorrect answer: </span><span class="si">#{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">load</span> <span class="s1">&#39;./questions.qm&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>编译的 Parse Phase，最终都是为了得到 AST（抽象语法树）这样类型的数据结构，所以，我们
先定义我们的数据结构：<code>Question</code> 和 <code>Answer</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># quiz.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Answer</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:text</span><span class="p">,</span> <span class="ss">:correct</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span> <span class="n">text</span><span class="p">,</span> <span class="n">correct</span>
</span><span class='line'>    <span class="vi">@text</span> <span class="o">=</span> <span class="n">text</span>
</span><span class='line'>    <span class="vi">@correct</span> <span class="o">=</span> <span class="n">correct</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Question</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span> <span class="n">text</span>
</span><span class='line'>    <span class="vi">@text</span> <span class="o">=</span> <span class="n">text</span>
</span><span class='line'>    <span class="vi">@answers</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">add_answer</span> <span class="n">answer</span>
</span><span class='line'>    <span class="vi">@answers</span> <span class="o">&lt;&lt;</span> <span class="n">answer</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">ask</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Question: </span><span class="si">#{</span><span class="vi">@text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="vi">@answers</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">answer</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">answer</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;Enter answer: &quot;</span>
</span><span class='line'>    <span class="n">answer</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">to_i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">return</span> <span class="vi">@answers</span><span class="o">[</span><span class="n">answer</span><span class="o">].</span><span class="n">correct</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>构建简单的 vm，赋予程序存储 DSL 内容的能力</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># quiz.rb</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;singleton&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Quiz</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@questions</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">add_question</span> <span class="n">question</span>
</span><span class='line'>    <span class="vi">@questions</span> <span class="o">&lt;&lt;</span> <span class="n">question</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">last_question</span>
</span><span class='line'>    <span class="vi">@questions</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">run_quiz</span>
</span><span class='line'>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="vi">@questions</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">q</span><span class="o">|</span> <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">ask</span> <span class="p">}</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;You got </span><span class="si">#{</span><span class="n">count</span><span class="si">}</span><span class="s2"> answers correct out of </span><span class="si">#{</span><span class="vi">@questions</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>载入、解析、存储、运行</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;./quiz&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">question</span> <span class="n">text</span>
</span><span class='line'>  <span class="no">Quiz</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">add_question</span> <span class="no">Question</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">wrong</span> <span class="n">text</span>
</span><span class='line'>  <span class="no">Quiz</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">last_question</span><span class="o">.</span><span class="n">add_answer</span> <span class="no">Answer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">right</span> <span class="n">text</span>
</span><span class='line'>  <span class="no">Quiz</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">last_question</span><span class="o">.</span><span class="n">add_answer</span> <span class="no">Answer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">load</span> <span class="s1">&#39;./questions.qm&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Quiz</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">run_quiz</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Gif 效果图</h2>

<p><img src="/downloads/images/dsl.gif"></p>

<h2>Ref</h2>

<ul>
<li><a href="http://jroller.com/rolsen/entry/building_a_dsl_in_ruby">Building a DSL in Ruby</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/15/thinking-education/">Thinking About Education</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-15T15:18:32+08:00'><span class='date'>2016-02-15 15:18:32</span> <span class='time'>3:18 pm</span></time>
        
           | <a href="/blog/2016/02/15/thinking-education/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/15/thinking-education/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前阵子在即刻上面订阅了「任志强写了新的长文章」，
最近任志强写了一篇 <a href="http://weibo.com/ttarticle/p/show?id=2309403942132896391799">有感而发（六）敎育</a>。</p>

<blockquote><p>美国的敎育是以案例为主的启发式敎育。通过案例将一些市场规律和发展方式展现出来，
让学员学会的是分析问题的方法和解决问题的思路，培养管理者独立思考的能力，而不是给你一个标准的答案。
告诉你多种方案中的利弊和可能发生的变化，让管理者根据自己的特长和优势选择对自己最有利的发展战略。</p>

<p>回想中国的敎育，大多是只给你灌输一个自认为正确的标准答案。
不是培养和开发学生的分析问题的方法，不是培育学生独立思考的能力，甚至不许有对标准答案质疑和探讨，更不许提出不同或否定的看法。
最严厉的惩罚则是只要与标准答案不同就只能得零分。
这一处罚的规定则起到的是不需要再努力思考的抑制作用。</p>

<p>独立思考意味着你要承担思考的后果和责任。独立思考才会产生责任感和创造性。
我们不但想知道答案，更要知道为什么？或者为什么不是另外一个比较中的最优选择？</p></blockquote>

<p>文章的许多观点，现实生活中大多数人早已深刻认识到，但我却属于后知后觉的一类。
直到 2012 年看到了一段话，才幡然觉醒，这几年随着对生活愈多的思考，愈加深刻的意识。</p>

<blockquote><p>德国两百年前的教育宣言曾经如此说到：教育的目的，不是培养人们适应传统的世界，不是着眼于实用性的知识和技能，
而是要去唤醒学生的力量，培养他们自我学习的主动性、抽象的归纳力和理解力，
以便使他们在目前无法预料的种种未来局势中，自我作出有意义的选择。</p></blockquote>

<p>其实在前面的<a href="/blog/2015/01/03/deep-thinking-about-my-2014/">博文</a>中，也早已谈过这样的事，
我不禁深入沉思：这几年我究竟有哪些变化，我有限的生命究竟想做和能做什么事情。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/15/be-a-good-programming-engineer/">A Good Programming Engineer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-15T14:19:26+08:00'><span class='date'>2016-02-15 14:19:26</span> <span class='time'>2:19 pm</span></time>
        
           | <a href="/blog/2016/02/15/be-a-good-programming-engineer/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/15/be-a-good-programming-engineer/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>接上次的一篇短博文，张克军的观点给了我接下来的学习指明了方向。</p>

<blockquote><p>对待技术发展要保持开放的心态，保持好奇心，持续学习。
如前面所述，要分清哪些是玩玩，哪些是工作需要，哪些需要深入学习</p></blockquote>

<p>最近，技术圈子的 <a href="http://weibo.com/u/1088413295">@Easy</a> 就 <a href="http://weibo.com/p/1003061170999921">@Laruence</a> 发的一条微博
也写了一篇关于不错的文章：<a href="http://weibo.com/ttarticle/p/show?id=2309403939907201539934">程序员是一个什么职业</a>。<br/>
文章虽然简短，但表述的观点具有发人深省的意义。</p>

<p>观点1：<strong>工程的本质不是创造，而是去风险化</strong></p>

<blockquote><p>工程是关于如何低成本、高效率、按时按量完成既定任务。所以判断一个工程师是否优秀，
并不是他多有创意多有名气，而是看他有多稳，看他多能 Get Things Done，中文就是「靠谱」。</p></blockquote>

<p>观点2：<strong>工程的另一个要求就是进度控制和质量控制</strong></p>

<blockquote><p>代码的及时入库与合并，自动化测试和每日构建，Code Review 和文档编写，这些看似无关紧要的习惯则决定了项目的质量。</p></blockquote>

<p>程序员职业路线</p>

<p><img src="/downloads/images/programming_career.jpg"></p>

<p><strong>这的确是程序员的一条职业路线图。但是媒体们不愿意告诉你的是</strong></p>

<blockquote><p>一：只有极少数程序员是通过这个路线成功的；<br/>
二：这条线其实需要太多非程序员职位的技能，比如产品设计能力和销售能力。</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/15/merge-sort/">归并排序</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-15T09:23:24+08:00'><span class='date'>2016-02-15 09:23:24</span> <span class='time'>9:23 am</span></time>
        
           | <a href="/blog/2016/02/15/merge-sort/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/15/merge-sort/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>归并排序（Merge sort），是建立在归并操作上的一种有效排序算法，时间复杂度为 O(n*log(n))。1945 年由约翰•冯•诺依曼首次提出。
该算法采用分治法（Divide and Conquer）的一个非常典型的应用，且各层分治递归可以同时进行。</p>

<h2>算法步骤</h2>

<p><strong>递归法</strong></p>

<ol>
<li>将序列每相邻两个数字进行归并操作，形成 floor(n/2) 个序列，排序后每个序列至多包含两个元素</li>
<li>将上述序列再次合并，形成 floor(n/4) 个序列，买个序列包含至多四个元素</li>
<li>重复步骤 2，直到所有元素排序完毕</li>
</ol>


<p>要点：首先需要将数列分割成尽可能小的数列，达到分治目的后再逐步合并。</p>

<p><strong>迭代法</strong></p>

<ol>
<li>申请空间，使其大小为两个已经排序序列之和，该空间用来存放合并后的序列</li>
<li>设定两个指针，最初位置分别为两个已经排序序列的起始位置</li>
<li>比较两个指针所指向的元素，选择相对小的元素放入合并空间，并移动指针到下一位置</li>
<li>重复 3 步骤直到某一指针到达序列尾</li>
<li>将另一序列剩下的所有元素直接复制到合并序列尾</li>
</ol>


<h2>GIF 演示图</h2>

<p><img src="/downloads/images/Merge-sort-example-300px.gif"></p>

<h2>归并排序 VS 快速排序</h2>

<ul>
<li>在实践中，快速排序执行速率更快</li>
<li>归并排序首先将数列划分为最小的数列，在对数列进行排序的同时，递增地对数列进行合并</li>
<li>快速排序不断地通过 pivot 划分数列，直到数列递归地有序</li>
</ul>


<h2>实现</h2>

<p><strong>ruby 实现</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span class='line'>    <span class="n">final</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">until</span> <span class="n">left</span><span class="o">.</span><span class="n">empty?</span> <span class="ow">or</span> <span class="n">right</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>        <span class="n">final</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">right</span><span class="o">.</span><span class="n">first</span> <span class="p">?</span> <span class="n">left</span><span class="o">.</span><span class="n">shift</span> <span class="p">:</span> <span class="n">right</span><span class="o">.</span><span class="n">shift</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">final</span> <span class="o">+</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">array</span> <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">2</span>
</span><span class='line'>    <span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'>    <span class="n">merge</span><span class="p">(</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">array</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">pivot</span><span class="o">]</span><span class="p">),</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">array</span><span class="o">[</span><span class="n">pivot</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">-</span><span class="mi">1</span><span class="o">]</span><span class="p">))</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>C 实现（递归法）</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">void</span> <span class="nf">merge_sort_recursive</span><span class="p">(</span><span class="kt">int</span> <span class="n">arr</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">start</span><span class="p">);</span> <span class="c1">// 右移一位，相当于除以 2</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">start1</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">end1</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">start2</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">end2</span> <span class="o">=</span> <span class="n">end</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">merge_sort_recursive</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">start1</span><span class="p">,</span> <span class="n">end1</span><span class="p">);</span>
</span><span class='line'>    <span class="n">merge_sort_recursive</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">end2</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 三个 while 实现了两个序列的有序合并</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="n">start1</span> <span class="o">&lt;=</span> <span class="n">end1</span> <span class="o">&amp;&amp;</span> <span class="n">start2</span> <span class="o">&lt;=</span> <span class="n">end2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">reg</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">start1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">start2</span><span class="p">]</span> <span class="o">?</span> <span class="n">arr</span><span class="p">[</span><span class="n">start1</span><span class="o">++</span><span class="p">]</span> <span class="o">:</span> <span class="n">arr</span><span class="p">[</span><span class="n">start2</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="p">(</span><span class="n">start1</span> <span class="o">&lt;=</span> <span class="n">end1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">reg</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">start1</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="p">(</span><span class="n">start2</span> <span class="o">&lt;=</span> <span class="n">end2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">reg</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">start2</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">arr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">arr</span><span class="p">[],</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">reg</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>
</span><span class='line'>    <span class="n">merge_sort_recursive</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>C 实现（迭代法）</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">min</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="kt">void</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">arr</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kt">int</span><span class="o">*</span> <span class="n">a</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">int</span><span class="o">*</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="n">len</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">));</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">seg</span><span class="p">,</span> <span class="n">start</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 使得内循环的 2seg+1 片段指数级变大，达到递归的效果</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="n">seg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">seg</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">seg</span> <span class="o">+=</span> <span class="n">seg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// 对 2seg+1 片段进行有序化</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">start</span> <span class="o">+=</span> <span class="n">seg</span> <span class="o">+</span> <span class="n">seg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">low</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">seg</span><span class="p">,</span> <span class="n">len</span><span class="p">),</span> <span class="n">high</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">seg</span> <span class="o">+</span> <span class="n">seg</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">low</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">start1</span> <span class="o">=</span> <span class="n">low</span><span class="p">,</span> <span class="n">end1</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">start2</span> <span class="o">=</span> <span class="n">mid</span><span class="p">,</span> <span class="n">end2</span> <span class="o">=</span> <span class="n">high</span><span class="p">;</span>
</span><span class='line'>          <span class="k">while</span> <span class="p">(</span><span class="n">start1</span> <span class="o">&lt;</span> <span class="n">end1</span> <span class="o">&amp;&amp;</span> <span class="n">start2</span> <span class="o">&lt;</span> <span class="n">end2</span><span class="p">)</span>
</span><span class='line'>              <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">start1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">start2</span><span class="p">]</span> <span class="o">?</span> <span class="n">a</span><span class="p">[</span><span class="n">start1</span><span class="o">++</span><span class="p">]</span> <span class="o">:</span> <span class="n">a</span><span class="p">[</span><span class="n">start2</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>          <span class="k">while</span> <span class="p">(</span><span class="n">start1</span> <span class="o">&lt;</span> <span class="n">end1</span><span class="p">)</span>
</span><span class='line'>              <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">start1</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>          <span class="k">while</span> <span class="p">(</span><span class="n">start2</span> <span class="o">&lt;</span> <span class="n">end2</span><span class="p">)</span>
</span><span class='line'>              <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">start2</span><span class="o">++</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="kt">int</span><span class="o">*</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
</span><span class='line'>      <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
</span><span class='line'>      <span class="n">b</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">arr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>          <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>      <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">free</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Ref</h2>

<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F">wikipedia 归并排序</a></li>
<li><a href="https://ruby-china.org/topics/20569">https://ruby-china.org/topics/20569</a></li>
<li><a href="http://blog.jobbole.com/90256/">http://blog.jobbole.com/90256/</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/14/quick-sort/">快速排序</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-14T17:38:13+08:00'><span class='date'>2016-02-14 17:38:13</span> <span class='time'>5:38 pm</span></time>
        
           | <a href="/blog/2016/02/14/quick-sort/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/14/quick-sort/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>快速排序使用分治法（Divide and conquer）策略来把一个序列（list）分为两个子序列（sub-lists）。</p>

<h2>算法步骤</h2>

<p><strong>递归法</strong></p>

<ol>
<li>从数列中挑出一个元素，称为基准（pivot）</li>
<li>重新排序数列，所有比 pivot 小的元素摆放在 pivot 左边，大的摆放在 pivot 右边。这个操作称为分割（partition）</li>
<li>递归地把 pivot 两边的子数列按 1 和 2 步骤继续排序</li>
</ol>


<p>要点：通过 pivot 不断地将数列分割成两个数列，达到分治的目的。</p>

<h2>时间复杂度</h2>

<ul>
<li>最好：O(n)</li>
<li>平均：O(n*log(n))</li>
<li>最差：O(n<sup>2</sup>)</li>
</ul>


<p>空间复杂度，不同实现不同。</p>

<p>快排在实践中，执行速度明显比其他具有相同时间复杂度的排序算法快。</p>

<h2>gif 演示图</h2>

<p><img src="/downloads/images/Quicksort-example.gif"></p>

<h2>实现</h2>

<p>Ruby 实现</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">quick_sort</span> <span class="n">arr</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">arr</span> <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">2</span>
</span><span class='line'>    <span class="n">left_arr</span><span class="p">,</span> <span class="n">right_arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">partition</span> <span class="p">{</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="n">arr</span><span class="o">.</span><span class="n">first</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">quick_sort</span><span class="p">(</span><span class="n">left_arr</span><span class="p">)</span> <span class="o">+</span> <span class="o">[</span><span class="n">arr</span><span class="o">.</span><span class="n">first</span><span class="o">]</span> <span class="o">+</span> <span class="n">quick_sort</span><span class="p">(</span><span class="n">right_arr</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>C 实现（递归）</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>
</span><span class='line'>    <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="o">*</span><span class="n">y</span><span class="p">;</span>
</span><span class='line'>    <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">quick_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">arr</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">];</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="o">&amp;&amp;</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span>
</span><span class='line'>            <span class="n">left</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pivot</span> <span class="o">&amp;&amp;</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span>
</span><span class='line'>            <span class="n">right</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="n">swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">]);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">left</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">quick_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">left</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="n">quick_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">left</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>参考</h2>

<ul>
<li><a href="http://visualgo.net/sorting.html">http://visualgo.net/sorting.html</a></li>
<li><a href="https://ruby-china.org/topics/20569">经典排序算法及 Ruby 实现</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F#C.E8.AA.9E.E8.A8.80">wikipedia-快速排序</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/03/frontend-talk/">关于最近的前端界吵架</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-03T14:53:12+08:00'><span class='date'>2016-02-03 14:53:12</span> <span class='time'>2:53 pm</span></time>
        
           | <a href="/blog/2016/02/03/frontend-talk/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/03/frontend-talk/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前阵子，尤雨溪和真阿当在微博上吵架的事情，估计已经传播到
整个技术界了。其实真没什么好吵的，但是我那几天还是乐滋滋地
每天上微博刷。</p>

<h2>争论的方法</h2>

<p>真阿当更多地是凭借自己所接触到的所以为的客观事实地下结论，
没有足够的数据支撑，且带着过了度的情绪在争论。
而尤雨溪则更多地想去阐述每个工具的出现都有其背景历史以及想要解决的问题。</p>

<p>离开技术的范畴，我支持尤雨溪的争论方法和态度。</p>

<h2>没有必要的争论</h2>

<p>真阿当所主张的基础很重要，与工具的出现其实并没有冲突，
工具的出现主要解决软件开发过程中所出现的工程学问题，
并不是为了解决初学者基础不足的问题。</p>

<h2>我认同张克军的观点</h2>

<p><a href="https://www.zhihu.com/question/38924821#answer-26964768">https://www.zhihu.com/question/38924821#answer-26964768</a></p>

<blockquote><p>对待技术发展要保持开放的心态，保持好奇心，持续学习。
如前面所述，要分清哪些是玩玩，哪些是工作需要，哪些需要深入学习</p></blockquote>

<p>这话点醒了我，因为目前，我在技术学习的时间分配上非常不合理。
日常保持着对不同技术领域资讯的跟进，由于时间分配不合理，
加上工作上也没有此方面的实践机会，始终有一种看了这么多但究竟有什么用的心态。</p>

<h2>对待争论</h2>

<ul>
<li>识别两方争论的点</li>
<li>识别两方争论的方法以及其论据</li>
<li>不站队，只获取对自己有益的信息即可</li>
</ul>


<p>这是个最坏的时代，也是最好的时代。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/03/tcp-chain/">TCP 链路是如何 Keep-Alive 的</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-03T13:51:50+08:00'><span class='date'>2016-02-03 13:51:50</span> <span class='time'>1:51 pm</span></time>
        
           | <a href="/blog/2016/02/03/tcp-chain/#disqus_thread"
             data-disqus-identifier="http://www.justqyx.me/blog/2016/02/03/tcp-chain/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>之前一直没有搞明白，HTTP 链路（即 TCP 链路）是如何 Keep-Alive 的。
这其实只是一个基础知识，只有知道与不知道的区别而已。</p>

<h2>如何定义一条 TCP 连接</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;源IP地址、源端口号、目的IP地址、目的端口号&gt;</span></code></pre></td></tr></table></div></figure>


<p>这四个值一起唯一地定义了一条连接。两条不同的 TCP 连接不能拥有 4 个完全相同
的地址组件值。</p>

<h2>TCP 链路</h2>

<p>数据从我们的计算机发出，在到达目标机器之前，需要经过许多其他结点。
这其中的每一个结点，需要维护两个 TCP 连接对象，使其能够与上一个结点和下一个结点通讯，
类似双向链表。</p>

<p>于是，一条链路就这么形成了。</p>

<p>一旦其中某个结点断开了连接，即移除了 TCP 连接对象，那么整条链路也就断开了，
并以主动断开或主动探测或超时断开的机制，对整条链路的 TCP 连接对象进行回收。</p>

<h2>TCP 连接是昂贵的</h2>

<p>建立 TCP 连接需要首先建立起通讯链路，并完成三次握手，故建立 TCP 连接的操作是昂贵的。
因此，以下依次出现的三种机制，是为了对 TCP 链路资源有更高效率的使用。</p>

<p><strong>Keep-Alive</strong></p>

<p>这是 HTTP/1.0 规范中增加的，但 HTTP/1.1 已经废弃。
为的是在完成 HTTP 事务操作之后保持 TCP 连接不关闭，使得下一个请求发起时，不再需要重新建立 TCP 连接。</p>

<p><strong>Persistent</strong></p>

<p>与 HTTP/1.0+ 的 Keep-Alive 连接不同，HTTP/1.1 的连接在默认情况下是激活的，
除非特别指明，否则 HTTP/1.1 假定所有连接都是持久的。要在事务处理结束之后将
连接关闭，HTTP/1.1 应用程序必须向报文中显示地增加一个 <code>Connection: Close</code> 首部。
这是与以前的 HTTP 协议版本很重要的区别，在以前的版本中，Kepp-Alive 连接要么是可选的，
要么根本就不支持。</p>

<p><strong>管道化连接</strong></p>

<p>HTTP/1.1 允许在持久连接上可选地使用请求管道。这是相对于 Keep-Alive 连接的又一次性能优化。
在响应到达之前，可以将多条请求放入队列。当第一条请求通过网络流向地球另一端的服务器时，
第二条和第三条请求也可以开始发送了。在高时延网络条件下，这样做可以降低网络的环回时间，
提高性能。</p>

<p>无论是 Keep-Alive 还是 Persistent 还是管道，HTTP 客户端都必须做好所有可能出错的情况，
因为在网络的世界里，每个结点都无法保证连接在那一刻是可用的，每个结点都可能随时关闭 TCP 连接。</p>

<h2>参考</h2>

<ul>
<li>《HTTP 权威指南》</li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/11/26/keep-attribute-safe-in-rails/">字段加密存储-Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/19/rubocop/">Use Rubocop to Control Your Ruby Code's Quality</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/13/actioncable-sourcecode-frontend-part-3-monitor/">ActionCable 源码阅读笔记-前端部分-3</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/13/actioncable-sourcecode-frontend-part-2-connection/">ActionCable 源码阅读笔记-前端部分-2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/13/actioncable-sourcecode-frontend-part-1-hello/">ActionCable 源码阅读笔记-前端部分-1</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/justqyx">@justqyx</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'justqyx',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2021 - 邱源鑫 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'yuanxin';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
